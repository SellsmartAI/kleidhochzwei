<!DOCTYPE html>
<html>
    <head>

        <link rel="stylesheet" href="style.css">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
<body>
    <script type="module" src="script1.js"></script>
  <form>
    <label for="name">Name:</label>

    <input type="text" id="name" required><br>

    <label for="email">Email:</label>
    <input type="email" id="email" required><br>

    <label for="phone">Phone Number:</label>
    <input type="tel" id="phone" required><br>

    <label for="address">Address:</label>
    <textarea id="address" required></textarea><br>

    <button type="button" onclick="generatePDF()">Generate PDF</button>
    
  </form>
  <button id="sheetButton" onclick="handleButtonClick()">Change Excel Data</button>

  <script>
   /* document.getElementById("sheetButton").addEventListener("click", main);

    async function main() {
        try {
            const name = document.getElementById("name").value;
            const email = document.getElementById("email").value;
            const phone = document.getElementById("phone").value;
            const address = document.getElementById("address").value;

            console.log(name + email + phone + address);

            const spreadsheetId = "1pfkEb6zvdBbdLK7PbRkewZhVXT0aCtO1uPt8OHvJ_hI"; // Replace with your actual spreadsheet ID

            const authResponse = await fetch(
                "https://accounts.google.com/o/oauth2/token", {
                method: "post",
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded"
                },
                body: `grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer&assertion=YOUR_JWT_TOKEN`
                // Replace YOUR_JWT_TOKEN with the JWT token obtained from your server (do not include the "Bearer " prefix)
            });

            const authData = await authResponse.json();
            const accessToken = authData.access_token;

            const rowData = [[name, email, phone, address]];

            const response = await fetch(
                `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/Tabellenblatt1:append?valueInputOption=USER_ENTERED`, {
                method: "post",
                headers: {
                    "Authorization": `Bearer ${accessToken}`,
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    values: rowData
                })
            });

            console.log("Row appended successfully.");
        } catch (error) {
            console.error("Error:", error.message);
        }
    }*/
</script>




  


  <!-- Include the first version of jsPDF for generating the PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js" integrity="sha512-qZvrmS2ekKPF2mSznTQsxqPgnpkI4DNTlrdUmTzrDgektczlKNRRhy5X5AAOnx5S09ydFYWWNSfcEqDTTHgtNA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <!-- Include the second version of jsPDF for emoji support -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.debug.js"></script>

  <script src="xlsx.full.min.js"></script>

  <script>
    function generatePDF() {
      const name = document.getElementById('name').value;
      const email = document.getElementById('email').value;
      const phone = document.getElementById('phone').value;
      const address = document.getElementById('address').value;

      const pdf = new jsPDF();
      pdf.text(`Name: ${name}`, 10, 20);
      pdf.text(`Email: ${email}`, 10, 40);
      pdf.text(`Phone Number: ${phone}`, 10, 60);
      pdf.text(`Address: ${address}`, 10, 80);

      pdf.save("personalized_pdf.pdf");
    }
   // your-script.js

  </script>
</body>
</html>
